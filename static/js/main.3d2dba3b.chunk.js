(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){},21:function(e,t,a){},22:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(6),c=a.n(o);const l="fa95a427198e4d4790c0be1b9a5d994c",s="https://j4mest.github.io/",i="user-read-currently-playing user-read-playback-state",m="https://accounts.spotify.com/authorize",d="https://accounts.spotify.com/api/token";var u=function(){const[e,t]=Object(n.useState)(null),[a,o]=Object(n.useState)(null),[c,u]=Object(n.useState)(null);Object(n.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("code"),a=localStorage.getItem("access_token"),n=localStorage.getItem("refresh_token");if(e){const a=localStorage.getItem("pkce_verifier");fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:e,redirect_uri:s,client_id:l,code_verifier:a})}).then(e=>e.json()).then(e=>{localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token),t(e.access_token),o(e.refresh_token),window.history.replaceState({},document.title,window.location.pathname)}).catch(console.error)}else a&&(t(a),o(n))},[]);const p=async()=>{const e=function(){const e=new Uint8Array(64);return window.crypto.getRandomValues(e),btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(),t=await async function(e){const t=(new TextEncoder).encode(e),a=await window.crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode(...new Uint8Array(a))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(e);localStorage.setItem("pkce_verifier",e);const a=`${m}?client_id=${l}`+"&response_type=code"+`&redirect_uri=${encodeURIComponent(s)}`+`&scope=${encodeURIComponent(i)}`+"&code_challenge_method=S256"+`&code_challenge=${t}`;window.location=a},h=Object(n.useCallback)(()=>{a&&fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:a,client_id:l})}).then(e=>e.json()).then(e=>{localStorage.setItem("access_token",e.access_token),t(e.access_token)}).catch(console.error)},[a]);return Object(n.useEffect)(()=>{if(!e)return;const t=async()=>{const t=await fetch("https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:`Bearer ${e}`}});if(401===t.status)return h();if(204===t.status||!t.ok)return u(null);const a=await t.json();a.is_playing&&a.item?u({title:a.item.name,artists:a.item.artists.map(e=>e.name).join(", "),albumArt:a.item.album.images[0].url,url:a.item.external_urls.spotify}):u(null)};t();const a=setInterval(t,15e3);return()=>clearInterval(a)},[e,h]),e?c?r.a.createElement("div",{className:"flex items-center bg-gray-900 text-white p-4 rounded-xl shadow-lg max-w-md"},r.a.createElement("img",{src:c.albumArt,alt:"Album Art",className:"w-16 h-16 rounded-lg mr-4 shadow-md"}),r.a.createElement("div",{className:"flex flex-col"},r.a.createElement("a",{href:c.url,target:"_blank",rel:"noopener noreferrer",className:"text-green-400 font-semibold text-lg hover:underline"},r.a.createElement("span",{role:"img","aria-label":"headphones"},"\ud83c\udfa7")," ",c.title),r.a.createElement("span",{className:"text-sm text-gray-300"},c.artists))):r.a.createElement("p",{className:"italic text-gray-500"},"Nothing playing right now."):r.a.createElement("button",{onClick:p,className:"px-6 py-2 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg shadow transition duration-300"},"Log in with Spotify")};const p="74f4c65fa40120881e93ed2e2e832c7d",h="Leicester";var f=function(){const[e,t]=Object(n.useState)(null);return Object(n.useEffect)(()=>{fetch(`https://api.openweathermap.org/data/2.5/weather?q=${h}&units=metric&appid=${p}`).then(e=>e.json()).then(e=>{t({temp:e.main.temp,condition:e.weather[0].main,icon:e.weather[0].icon})}).catch(console.error)},[]),e?r.a.createElement("div",{className:"flex items-center bg-blue-100 text-blue-900 p-4 rounded-xl shadow max-w-sm mt-4"},r.a.createElement("img",{src:`https://openweathermap.org/img/wn/${e.icon}@2x.png`,alt:e.condition,className:"w-12 h-12 mr-4"}),r.a.createElement("div",null,r.a.createElement("p",{className:"font-semibold"},h),r.a.createElement("p",null,e.temp,"\xb0C \u2013 ",e.condition))):r.a.createElement("p",{className:"text-gray-500 italic"},"Loading weather...")},g=(a(18),a(7)),w=a.n(g);var b=function(){const[e,t]=Object(n.useState)([]),a="https://outlook.office365.com/owa/calendar/31941d49ba5446068f8d6e9f44174234@student.le.ac.uk/ed5d16aaf1534ef08673eed39f85ea515267399925583823516/calendar.ics";return Object(n.useEffect)(()=>{w.a.fromURL(a,{},(e,a)=>{if(e)return void console.error("Failed to load calendar",e);const n=new Date,r=Object.values(a).filter(e=>"VEVENT"===e.type).map(e=>({uid:e.uid,summary:e.summary,start:e.start,end:e.end,location:e.location||"",url:e.url||"#"})).filter(e=>new Date(e.end)>=n).sort((e,t)=>new Date(e.start)-new Date(t.start));t(r)})},[a]),r.a.createElement("div",{className:"mt-6"},r.a.createElement("h2",{className:"text-xl font-semibold mb-4"},"\ud83d\udcc5 Upcoming Events"),r.a.createElement("div",{className:"bg-white shadow rounded p-4 space-y-4"},0===e.length?r.a.createElement("p",{className:"text-gray-500"},"No upcoming events."):e.map(e=>r.a.createElement("a",{key:e.uid,href:e.url,target:"_blank",rel:"noopener noreferrer",className:"block hover:bg-gray-100 p-3 rounded"},r.a.createElement("div",{className:"font-medium truncate"},e.summary),r.a.createElement("div",{className:"text-sm text-gray-500 truncate"},new Date(e.start).toLocaleString("en-GB",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),e.location&&` \u2022 ${e.location}`)))))};var y=function(){return r.a.createElement("div",{className:"App p-6 font-sans"},r.a.createElement("header",{className:"mb-8"},r.a.createElement("h1",{className:"text-3xl font-bold"},"Welcome to J4mesT's Site")),r.a.createElement("section",{className:"mb-8"},r.a.createElement("h2",{className:"text-xl font-semibold mb-2"},"Now Listening"),r.a.createElement(u,null)),r.a.createElement("section",null,r.a.createElement("h2",{className:"text-xl font-semibold mb-2"},"Weather"),r.a.createElement(f,null)),r.a.createElement("section",null,r.a.createElement(b,null)))};a(21);c.a.createRoot(document.getElementById("root")).render(r.a.createElement(y,null))},9:function(e,t,a){e.exports=a(22)}},[[9,1,2]]]);
//# sourceMappingURL=main.3d2dba3b.chunk.js.map